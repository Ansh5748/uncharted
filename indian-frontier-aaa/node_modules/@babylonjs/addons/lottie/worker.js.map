{"version":3,"file":"worker.js","sourceRoot":"","sources":["../../../../dev/addons/src/lottie/worker.ts"],"names":[],"mappings":"AAGA,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,IAAI,eAAe,GAAkC,IAAI,CAAC;AAE1D;;GAEG;AACH,MAAM,oBAAoB,GAAG;IACzB,aAAa,EAAE,KAAK,EAAE,oCAAoC;IAC1D,eAAe,EAAE,IAAI,EAAE,4BAA4B;IACnD,OAAO,EAAE,CAAC,EAAE,sCAAsC;IAClD,eAAe,EAAE,EAAE,EAAE,4DAA4D;IACjF,eAAe,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,4CAA4C;IACzF,eAAe,EAAE,CAAC,EAAE,qDAAqD;IACzE,gBAAgB,EAAE,CAAC,EAAE,gBAAgB;IACrC,WAAW,EAAE,CAAC,EAAE,iHAAiH;IACjI,uBAAuB,EAAE,IAAI,EAAE,uDAAuD;IACtF,iBAAiB,EAAE,KAAK,EAAE,4DAA4D;CAC/C,CAAC;AAE5C,SAAS,GAAG,KAAK,WAAW,GAAG;IAC3B,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;QACnC,MAAM,MAAM,GAAG,GAAG,CAAC,IAAI,CAAC,MAA2B,CAAC;QACpD,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC,IAAc,CAAC;QACrC,MAAM,cAAc,GAAG,GAAG,CAAC,IAAI,CAAC,MAAgC,CAAC;QACjE,MAAM,WAAW,GAA2B;YACxC,GAAG,oBAAoB;YACvB,GAAG,cAAc;SACpB,CAAC;QAEF,MAAM,aAAa,GAAG,MAAM,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;QACvD,eAAe,GAAG,IAAI,mBAAmB,CAAC,MAAM,EAAE,aAAa,EAAE,WAAW,CAAC,CAAC;QAE9E,WAAW,CAAC;YACR,cAAc,EAAE,eAAe,CAAC,cAAc;YAC9C,eAAe,EAAE,eAAe,CAAC,eAAe;SACnD,CAAC,CAAC;QAEH,eAAe,CAAC,aAAa,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;IAC7D,CAAC;SAAM,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;QAC3C,eAAe,IAAI,eAAe,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAChF,CAAC;AACL,CAAC,CAAC","sourcesContent":["import type { Nullable } from \"core/types\";\r\n\r\nimport type { AnimationConfiguration } from \"./lottiePlayer\";\r\nimport { AnimationController } from \"./rendering/animationController\";\r\n\r\nlet AnimationPlayer: Nullable<AnimationController> = null;\r\n\r\n/**\r\n * Default configuration for lottie animations playback.\r\n */\r\nconst DefaultConfiguration = {\r\n    loopAnimation: false, // By default do not loop animations\r\n    spriteAtlasSize: 2048, // Size of the texture atlas\r\n    gapSize: 5, // Gap around the sprites in the atlas\r\n    spritesCapacity: 64, // Maximum number of sprites the renderer can handle at once\r\n    backgroundColor: { r: 1, g: 1, b: 1, a: 1 }, // Background color for the animation canvas\r\n    scaleMultiplier: 5, // Minimum scale factor to prevent too small sprites,\r\n    devicePixelRatio: 1, // Scale factor,\r\n    easingSteps: 4, // Number of steps to sample easing functions for animations - Less than 4 causes issues with some interpolations\r\n    ignoreOpacityAnimations: true, // Whether to ignore opacity animations for performance\r\n    supportDeviceLost: false, // Whether to support device lost events for WebGL contexts,\r\n} as const satisfies AnimationConfiguration;\r\n\r\nonmessage = async function (evt) {\r\n    if (evt.data.canvas && evt.data.file) {\r\n        const canvas = evt.data.canvas as HTMLCanvasElement;\r\n        const file = evt.data.file as string;\r\n        const originalConfig = evt.data.config as AnimationConfiguration;\r\n        const finalConfig: AnimationConfiguration = {\r\n            ...DefaultConfiguration,\r\n            ...originalConfig,\r\n        };\r\n\r\n        const animationData = await (await fetch(file)).text();\r\n        AnimationPlayer = new AnimationController(canvas, animationData, finalConfig);\r\n\r\n        postMessage({\r\n            animationWidth: AnimationPlayer.animationWidth,\r\n            animationHeight: AnimationPlayer.animationHeight,\r\n        });\r\n\r\n        AnimationPlayer.playAnimation(finalConfig.loopAnimation);\r\n    } else if (evt.data.width && evt.data.height) {\r\n        AnimationPlayer && AnimationPlayer.setSize(evt.data.width, evt.data.height);\r\n    }\r\n};\r\n"]}
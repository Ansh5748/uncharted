{"version":3,"file":"node.js","sourceRoot":"","sources":["../../../../../dev/addons/src/lottie/rendering/node.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IVector2Like } from \"core/Maths/math.like\";\r\n\r\nimport type { ScalarProperty, Vector2Property } from \"../lottie/parsedTypes\";\r\n\r\nimport { ThinMatrix } from \"../maths/matrix\";\r\n\r\n/**\r\n * Represents a node in the scenegraph that contains the animation information from a lottie animation layer or group.\r\n */\r\nexport class Node {\r\n    private readonly _id: string;\r\n    private readonly _ignoreOpacityAnimations: boolean;\r\n    private readonly _position: Vector2Property;\r\n    private readonly _rotation: ScalarProperty;\r\n    private readonly _scale: Vector2Property;\r\n    private _worldMatrix: ThinMatrix;\r\n    private _localMatrix: ThinMatrix;\r\n    private _globalMatrix: ThinMatrix;\r\n\r\n    private readonly _opacity: ScalarProperty;\r\n\r\n    private readonly _parent: Node | undefined;\r\n    private readonly _children: Node[];\r\n\r\n    private _isVisible = false;\r\n\r\n    private _isAnimated = false;\r\n\r\n    private _animationsFunctions: ((frame: number) => boolean)[] = [];\r\n\r\n    protected _isControl = false;\r\n    protected _isShape = false;\r\n\r\n    /**\r\n     * Gets the id of this node.\r\n     * @returns The unique identifier of this node.\r\n     */\r\n    public get id(): string {\r\n        return this._id;\r\n    }\r\n\r\n    /**\r\n     * Gets the childer of this node.\r\n     * @returns An array of child nodes.\r\n     */\r\n    public get children(): Node[] {\r\n        return this._children;\r\n    }\r\n\r\n    /**\r\n     * Gets whether this node is a shape.\r\n     * @returns True if this node is a shape, false otherwise.\r\n     */\r\n    public get isShape(): boolean {\r\n        return this._isShape;\r\n    }\r\n\r\n    /**\r\n     * Gets the world matrix of this node.\r\n     * @returns The world matrix.\r\n     */\r\n    public get worldMatrix(): ThinMatrix {\r\n        return this._worldMatrix;\r\n    }\r\n\r\n    /**\r\n     * Gets whether this node is animated.\r\n     * @returns True if this node has animations, false otherwise.\r\n     */\r\n    public get isAnimated(): boolean {\r\n        return this._isAnimated;\r\n    }\r\n\r\n    /**\r\n     * Gets the opacity of this node.\r\n     * If the node is not visible, the opacity will be 0.\r\n     * @returns The opacity of the node, from 0 to 1.\r\n     */\r\n    public get opacity(): number {\r\n        if (!this._isVisible) {\r\n            return 0;\r\n        }\r\n\r\n        return this._opacity.currentValue / 100.0;\r\n    }\r\n\r\n    /**\r\n     * Gets the initial scale of this node.\r\n     * @returns The initial scale.\r\n     */\r\n    public get startScale(): IVector2Like {\r\n        return this._scale.startValue;\r\n    }\r\n\r\n    /**\r\n     * Gets the parent node of this node.\r\n     * @returns The parent node, or undefined if this is a root node.\r\n     */\r\n    public get parent(): Node | undefined {\r\n        return this._parent;\r\n    }\r\n\r\n    /**\r\n     * Sets the node visibility.\r\n     * @param value The new visibility value.\r\n     */\r\n    public set isVisible(value: boolean) {\r\n        if (this._isVisible === value) {\r\n            return; // No change in visibility\r\n        }\r\n        this._isVisible = value;\r\n        // Propage to children\r\n        for (let i = 0; i < this._children.length; i++) {\r\n            this._children[i].isVisible = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Constructs a new node.\r\n     * @param id Unique identifier for the node.\r\n     * @param ignoreOpacityAnimations If there are no animations on opacity, mark this as true to ignore and optimize CPU usage.\r\n     * @param position Position of the node in the scene.\r\n     * @param rotation Rotation of the node in degrees.\r\n     * @param scale Scale of the node in the scene.\r\n     * @param opacity Opacity of the node, from 0 to 1.\r\n     * @param parent Parent node in the scenegraph.\r\n     */\r\n    public constructor(\r\n        id: string,\r\n        ignoreOpacityAnimations: boolean,\r\n        position?: Vector2Property,\r\n        rotation?: ScalarProperty,\r\n        scale?: Vector2Property,\r\n        opacity?: ScalarProperty,\r\n        parent?: Node\r\n    ) {\r\n        this._isVisible = false;\r\n\r\n        this._id = id;\r\n        this._ignoreOpacityAnimations = ignoreOpacityAnimations;\r\n\r\n        this._position = position || { startValue: { x: 0, y: 0 }, currentValue: { x: 0, y: 0 }, currentKeyframeIndex: 0 };\r\n        this._rotation = rotation || { startValue: 0, currentValue: 0, currentKeyframeIndex: 0 };\r\n        this._scale = scale || { startValue: { x: 1, y: 1 }, currentValue: { x: 1, y: 1 }, currentKeyframeIndex: 0 };\r\n        this._localMatrix = new ThinMatrix();\r\n        this._globalMatrix = new ThinMatrix();\r\n\r\n        // Store the matrix at least once\r\n        this._localMatrix.compose(this._scale.currentValue, this._rotation.currentValue, this._position.currentValue);\r\n\r\n        this._opacity = opacity || { startValue: 100, currentValue: 100, currentKeyframeIndex: 0 };\r\n\r\n        // Animated ?\r\n        if (this._position.keyframes !== undefined && this._position.keyframes.length > 0) {\r\n            this._isAnimated = true;\r\n            this._animationsFunctions.push((frame) => {\r\n                return this._updatePosition(frame);\r\n            });\r\n        }\r\n\r\n        if (this._rotation.keyframes !== undefined && this._rotation.keyframes.length > 0) {\r\n            this._isAnimated = true;\r\n            this._animationsFunctions.push((frame) => {\r\n                return this._updateRotation(frame);\r\n            });\r\n        }\r\n\r\n        if (this._scale.keyframes !== undefined && this._scale.keyframes.length > 0) {\r\n            this._isAnimated = true;\r\n            this._animationsFunctions.push((frame) => {\r\n                return this._updateScale(frame);\r\n            });\r\n        }\r\n\r\n        // Parenting\r\n        this._children = [];\r\n        if (parent) {\r\n            this._worldMatrix = this._globalMatrix;\r\n\r\n            if (parent.isAnimated || !parent.parent || this.isAnimated || parent._isControl) {\r\n                this._parent = parent;\r\n                parent._children.push(this);\r\n                this._localMatrix.multiplyToRef(parent._worldMatrix, this._globalMatrix);\r\n            } else {\r\n                // We can merge them\r\n                this._localMatrix.multiplyToRef(parent._localMatrix, this._localMatrix);\r\n\r\n                // New parent\r\n                this._parent = parent.parent;\r\n                this._localMatrix.multiplyToRef(this._parent._worldMatrix, this._globalMatrix);\r\n                parent.parent._children.push(this);\r\n            }\r\n        } else {\r\n            this._worldMatrix = this._localMatrix;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Resets the node's properties to their initial values.\r\n     */\r\n    public reset(): void {\r\n        // Vectors need to be copied to avoid modifying the original start values\r\n        this._position.currentValue = { x: this._position.startValue.x, y: this._position.startValue.y };\r\n        if (this._position.keyframes) {\r\n            this._position.currentKeyframeIndex = 0;\r\n        }\r\n\r\n        this._rotation.currentValue = this._rotation.startValue;\r\n        if (this._rotation.keyframes) {\r\n            this._rotation.currentKeyframeIndex = 0;\r\n        }\r\n\r\n        this._scale.currentValue = { x: this._scale.startValue.x, y: this._scale.startValue.y };\r\n        if (this._scale.keyframes) {\r\n            this._scale.currentKeyframeIndex = 0;\r\n        }\r\n\r\n        this._opacity.currentValue = this._opacity.startValue;\r\n        if (this._opacity.keyframes) {\r\n            this._opacity.currentKeyframeIndex = 0;\r\n        }\r\n\r\n        for (let i = 0; i < this._children.length; i++) {\r\n            this._children[i].reset();\r\n        }\r\n\r\n        // On reset update the scenegraph so all matrices are reset to their initial values\r\n        if (this._parent === undefined) {\r\n            this.update(0, false, true);\r\n        }\r\n\r\n        this._isVisible = false;\r\n    }\r\n\r\n    /**\r\n     * Updates the node's properties based on the current frame of the animation.\r\n     * @param frame Frame number we are playing in the animation.\r\n     * @param isParentUpdated Whether the parent node has been updated.\r\n     * @param isReset Whether the node is being reset.\r\n     * @returns True if the node was updated, false otherwise.\r\n     */\r\n    public update(frame: number, isParentUpdated = false, isReset = false): boolean {\r\n        let isUpdated = false || isReset;\r\n\r\n        if (this.isAnimated) {\r\n            for (let i = 0; i < this._animationsFunctions.length; i++) {\r\n                isUpdated = this._animationsFunctions[i](frame) || isUpdated;\r\n            }\r\n\r\n            if (isUpdated) {\r\n                this._localMatrix.compose(this._scale.currentValue, this._rotation.currentValue, this._position.currentValue);\r\n            }\r\n        }\r\n\r\n        if (this._parent) {\r\n            if (isParentUpdated || isUpdated) {\r\n                this._localMatrix.multiplyToRef(this._parent._worldMatrix, this._globalMatrix);\r\n            }\r\n        }\r\n\r\n        if (!this._ignoreOpacityAnimations) {\r\n            this._updateOpacity(frame);\r\n        }\r\n\r\n        for (let i = 0; i < this._children.length; i++) {\r\n            this._children[i].update(frame, isUpdated || isParentUpdated);\r\n        }\r\n\r\n        return isUpdated || isParentUpdated;\r\n    }\r\n\r\n    private _updatePosition(frame: number): boolean {\r\n        const keyframes = this._position.keyframes!;\r\n\r\n        if (frame < keyframes[0].time) {\r\n            return false; // Animation not started yet\r\n        }\r\n\r\n        if (frame > keyframes[keyframes.length - 1].time) {\r\n            this._position.currentValue = keyframes[keyframes.length - 1].value;\r\n            return true;\r\n        }\r\n\r\n        // Find the right keyframe we are currently in\r\n        let currentFrameIndex = -1;\r\n        for (let i = this._position.currentKeyframeIndex; i < keyframes.length - 1; i++) {\r\n            if (frame >= keyframes[i].time && frame < keyframes[i + 1].time) {\r\n                currentFrameIndex = i;\r\n                this._position.currentKeyframeIndex = currentFrameIndex;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (currentFrameIndex === -1) {\r\n            return false; // No valid keyframe found for the current animation frame\r\n        }\r\n\r\n        const currentVector2Keyframe = keyframes[currentFrameIndex];\r\n        const nextVector2Keyframe = keyframes[currentFrameIndex + 1];\r\n\r\n        // Animate the position\r\n        const gradient = (frame - currentVector2Keyframe.time) / (nextVector2Keyframe.time - currentVector2Keyframe.time);\r\n\r\n        const easeGradientFactor = currentVector2Keyframe.easeFunction1.interpolate(gradient);\r\n        this._position.currentValue.x = currentVector2Keyframe.value.x + easeGradientFactor * (nextVector2Keyframe.value.x - currentVector2Keyframe.value.x);\r\n\r\n        const easeGradientFactor2 = currentVector2Keyframe.easeFunction2.interpolate(gradient);\r\n        this._position.currentValue.y = currentVector2Keyframe.value.y + easeGradientFactor2 * (nextVector2Keyframe.value.y - currentVector2Keyframe.value.y);\r\n\r\n        return true;\r\n    }\r\n\r\n    private _updateRotation(frame: number): boolean {\r\n        const keyframes = this._rotation.keyframes!;\r\n\r\n        if (frame < keyframes[0].time) {\r\n            return false; // Animation not started yet\r\n        }\r\n\r\n        if (frame > keyframes[keyframes.length - 1].time) {\r\n            this._rotation.currentValue = keyframes[keyframes.length - 1].value;\r\n            return true;\r\n        }\r\n\r\n        // Find the right keyframe we are currently in\r\n        let currentFrameIndex = -1;\r\n        for (let i = this._rotation.currentKeyframeIndex; i < keyframes.length - 1; i++) {\r\n            if (frame >= keyframes[i].time && frame < keyframes[i + 1].time) {\r\n                currentFrameIndex = i;\r\n                this._rotation.currentKeyframeIndex = currentFrameIndex;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (currentFrameIndex === -1) {\r\n            return false; // No valid keyframe found for the current animation frame\r\n        }\r\n\r\n        const currentScalarKeyframe = keyframes[currentFrameIndex];\r\n        const nextScalarKeyframe = keyframes[currentFrameIndex + 1];\r\n\r\n        // Animate the position\r\n        const gradient = (frame - currentScalarKeyframe.time) / (nextScalarKeyframe.time - currentScalarKeyframe.time);\r\n\r\n        const easeGradientFactor = currentScalarKeyframe.easeFunction.interpolate(gradient);\r\n        this._rotation.currentValue = -(currentScalarKeyframe.value + easeGradientFactor * (nextScalarKeyframe.value - currentScalarKeyframe.value));\r\n\r\n        return true;\r\n    }\r\n\r\n    private _updateScale(frame: number): boolean {\r\n        const keyframes = this._scale.keyframes!;\r\n\r\n        if (frame < keyframes[0].time) {\r\n            return false; // Animation not started yet\r\n        }\r\n\r\n        if (frame > keyframes[keyframes.length - 1].time) {\r\n            this._scale.currentValue = keyframes[keyframes.length - 1].value;\r\n            return true;\r\n        }\r\n\r\n        // Find the right keyframe we are currently in\r\n        let currentFrameIndex = -1;\r\n        for (let i = this._scale.currentKeyframeIndex; i < keyframes.length - 1; i++) {\r\n            if (frame >= keyframes[i].time && frame < keyframes[i + 1].time) {\r\n                currentFrameIndex = i;\r\n                this._scale.currentKeyframeIndex = currentFrameIndex;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (currentFrameIndex === -1) {\r\n            return false; // No valid keyframe found for the current animation frame\r\n        }\r\n\r\n        const currentVector2Keyframe = keyframes[currentFrameIndex];\r\n        const nextVector2Keyframe = keyframes[currentFrameIndex + 1];\r\n\r\n        // Animate the scale\r\n        const gradient = (frame - currentVector2Keyframe.time) / (nextVector2Keyframe.time - currentVector2Keyframe.time);\r\n\r\n        const easeGradientFactor = currentVector2Keyframe.easeFunction1.interpolate(gradient);\r\n        this._scale.currentValue.x = currentVector2Keyframe.value.x + easeGradientFactor * (nextVector2Keyframe.value.x - currentVector2Keyframe.value.x);\r\n\r\n        const easeGradientFactor2 = currentVector2Keyframe.easeFunction2.interpolate(gradient);\r\n        this._scale.currentValue.y = currentVector2Keyframe.value.y + easeGradientFactor2 * (nextVector2Keyframe.value.y - currentVector2Keyframe.value.y);\r\n\r\n        return true;\r\n    }\r\n\r\n    private _updateOpacity(frame: number): boolean {\r\n        if (this._opacity.keyframes === undefined || this._opacity.keyframes.length === 0) {\r\n            return false;\r\n        }\r\n\r\n        if (frame < this._opacity.keyframes[0].time) {\r\n            return false; // Animation not started yet\r\n        }\r\n\r\n        if (frame > this._opacity.keyframes[this._opacity.keyframes.length - 1].time) {\r\n            this._opacity.currentValue = this._opacity.keyframes[this._opacity.keyframes.length - 1].value;\r\n            return true;\r\n        }\r\n\r\n        // Find the right keyframe we are currently in\r\n        let currentFrameIndex = -1;\r\n        for (let i = this._opacity.currentKeyframeIndex; i < this._opacity.keyframes.length - 1; i++) {\r\n            if (frame >= this._opacity.keyframes[i].time && frame < this._opacity.keyframes[i + 1].time) {\r\n                currentFrameIndex = i;\r\n                this._opacity.currentKeyframeIndex = currentFrameIndex;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (currentFrameIndex === -1) {\r\n            return false; // No valid keyframe found for the current animation frame\r\n        }\r\n\r\n        const currentScalarKeyframe = this._opacity.keyframes[currentFrameIndex];\r\n        const nextScalarKeyframe = this._opacity.keyframes[currentFrameIndex + 1];\r\n\r\n        // Animate the opacity\r\n        const gradient = (frame - currentScalarKeyframe.time) / (nextScalarKeyframe.time - currentScalarKeyframe.time);\r\n\r\n        const easeGradientFactor = currentScalarKeyframe.easeFunction.interpolate(gradient);\r\n        this._opacity.currentValue = currentScalarKeyframe.value + easeGradientFactor * (nextScalarKeyframe.value - currentScalarKeyframe.value);\r\n\r\n        return true;\r\n    }\r\n}\r\n"]}